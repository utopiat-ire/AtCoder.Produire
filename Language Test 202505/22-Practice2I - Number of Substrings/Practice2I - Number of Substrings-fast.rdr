※コンソール
※コンパイル
【S：文字列】＝コンソールから受け取る
【sa：長整数の配列】＝Sを接尾辞配列する
【la：長整数の配列】＝Sをsaで最長共通接尾辞配列する
【n：長整数】＝Sの文字数
【ans：長整数】＝n×(n+1)￥2-(laの合計)
ansを表示

【s：文字列】を接尾辞配列する手順：整数の配列
    【idx：長整数の配列】＝{}
    【n：整数】＝sの文字数
    idx(n)＝「」
    n回【i：整数】にカウントしながら繰り返す
        idx(i)＝i
    そして
	idxを『
		それを{【l：長整数】,【r：長整数】}とみなす
		【比較値】=sのl文字目の文字番号-sのr文字目の文字番号
		比較値<0なら
			-1を返す
		他で比較値>0なら
			1を返す
		そうでなければ
			0を返す
		そして
	』で並べ替える
	【s2：整数の配列】＝{}
    s2(n)=0
	【now：整数】＝1
	n回【i：整数】にカウントしながら繰り返す
		iが2以上なら
			【l：整数】＝idx(i-1)
			【r：整数】＝idx(i)
			sのl文字目≠sのr文字目なら
				now=now+1
			そして
		そして
		s2(idx(i))=now
    そして
	【res：整数の配列】＝s2をnowでSAISする
	resを返す
終わり

【s：整数の配列】を【upper：整数】でSAISする手順：整数の配列
    【sa：整数の配列】＝{}
    【n：整数】＝sの個数
    nが0なら
		saを返す
	他でnが1なら
		sa(1)＝1
		saを返す
	他でnが2なら
		s(1)<s(2)なら
			sa={1,2}
		そうでなければ
			sa={2,1}
		そして
		saを返す
	そして

	n≦10なら
		sを愚直接尾辞配列するを返す
	そして

	sa(n)=0
	【ls：真偽値の配列】={}
	ls(n)=×
	【i：整数】をn-1から-1ずつ増やしながら1まで繰り返す
		s(i)=s(i+1)なら
			ls(i)=ls(i+1)
		そうでなければ
			ls(i)=s(i)<s(i+1)
		そして
	そして
	【sum_l：整数の配列】={}
	【sum_s：整数の配列】={}
	sum_l(upper)=0
	sum_s(upper)=0
	n回【i：整数】にカウントしながら繰り返す
		ls(i)なら
			sum_l(s(i)+1) = sum_l(s(i)+1) + 1
		そうでなければ
			sum_s(s(i)) = sum_s(s(i)) + 1
		そして
    そして
	upper回【i：整数】にカウントしながら繰り返す
		sum_s(i) = sum_s(i) + sum_l(i)
		i<upperなら
			sum_l(i+1) = sum_l(i+1) + sum_s(i)
		そして
    そして

	【lms_map：整数の配列】={}
	lms_map(n+1)=-1
	lms_map(1)=-1
	【m：整数】=0
	【i：整数】を2から1ずつ増やしながらnまで繰り返す
		ls(i)かつls(i-1)=×なら
			m = m + 1
			lms_map(i) = m
		そうでなければ
			lms_map(i) = -1
		そして
	そして
	【lms：整数の配列】={}
	m>0なら
		lms(m)=0
	そして
	m=0
	n-1回【i：整数】にカウントしながら繰り返す
		ls(i+1)かつls(i)=×なら
			m = m + 1
			lms(m) = i+1
		そして
	そして

	n回【i：整数】にカウントしながら繰り返す
		sa(i)=-1
	そして
	【buf：整数の配列】=sum_sのクローン
	lmsをdへそれぞれ繰り返す
		d>nなら
			出る
		そして
		buf(s(d))=buf(s(d))+1
		sa(buf(s(d)))=d
	そして
	
	buf=sum_lのクローン
	buf(s(n))=buf(s(n))+1
	sa(buf(s(n)))=n
	n回【i：整数】にカウントしながら繰り返す
		【v：整数】=sa(i)
		v>1かつls(v-1)=×なら
			buf(s(v-1))=buf(s(v-1))+1
			sa(buf(s(v-1)))=v-1
		そして
	そして
	buf=sum_lのクローン
	【i:整数】をnから-1ずつ増やしながら1まで繰り返す
		【v：整数】=sa(i)
		v>1かつls(v-1)なら
			sa(buf(s(v-1)+1))=v-1
			buf(s(v-1)+1)=buf(s(v-1)+1)-1
		そして
	そして

	m>0なら
		【sorted_lms：整数の配列】={}
		sorted_lms(m)=0
		m=0
		saをvへそれぞれ繰り返す
			lms_map(v)≠-1なら
				m = m+1
				sorted_lms(m)=v
			そして
		そして
		【rec_s：整数の配列】={}
		rec_s(m)=1
		m回【i：整数】にカウントしながら繰り返す
			rec_s(i)=1
		そして
		【rec_upper：整数】=1
		
		【i：整数】を2から1ずつ増やしながらmまで繰り返す
			【l：整数】=sorted_lms(i-1)
			【r：整数】=sorted_lms(i)
			【end_l：整数】
			【end_r：整数】
			lms_map(l)<mなら
				end_l=lms(lms_map(l)+1)
			そうでなければ
				end_l=n+1
			そして
			lms_map(r)<mなら
				end_r=lms(lms_map(r)+1)
			そうでなければ
				end_r=n+1
			そして
			【same：真偽値】=○
			end_l-l≠end_r-rなら
				same=×
			そうでなければ
				l<end_lの間、繰り返す
					s(l)≠s(r)なら
						出る
					そして
					l = l+1
					r = r+1
				そして
				l>nまたはs(l)≠s(r)なら
					same=×
				そして
			そして
			sameが×なら
				rec_upper=rec_upper+1
			そして
			rec_s(lms_map(sorted_lms(i))) = rec_upper
		そして
		【rec_sa：整数の配列】=rec_sをrec_upperでSAISする
		m回【i：整数】にカウントしながら繰り返す
			sorted_lms(i)=lms(rec_sa(i))
		そして

		n回【i：整数】にカウントしながら繰り返す
			sa(i)=-1
		そして
		【buf：整数の配列】=sum_sのクローン
		sorted_lmsをdへそれぞれ繰り返す
			d>nなら
				出る
			そして
			buf(s(d))=buf(s(d))+1
			sa(buf(s(d)))=d
		そして
		
		buf=sum_lのクローン
		buf(s(n))=buf(s(n))+1
		sa(buf(s(n)))=n
		n回【i：整数】にカウントしながら繰り返す
			【v：整数】=sa(i)
			v>1かつls(v-1)=×なら
				buf(s(v-1))=buf(s(v-1))+1
				sa(buf(s(v-1)))=v-1
			そして
		そして
		buf=sum_lのクローン
		【i:整数】をnから-1ずつ増やしながら1まで繰り返す
			【v：整数】=sa(i)
			v>1かつls(v-1)なら
				sa(buf(s(v-1)+1))=v-1
				buf(s(v-1)+1)=buf(s(v-1)+1)-1
			そして
		そして
	そして
	saを返す
終わり

【s：整数の配列】を愚直接尾辞配列する手順：整数の配列
    【idx：整数の配列】＝{}
    【n：整数】＝sの個数
    idx(n)＝0
    n回【i：整数】にカウントしながら繰り返す
        idx(i)＝i
    そして
	idxを『
		それを{【l：整数】,【r：整数】}とみなす
		繰り返す
			sのl番目<sのr番目なら
				-1を返す
			他でsのl番目>sのr番目なら
				1を返す
			そうでなければ
				l=nかつr=nなら
					0を返す
				他でl=nなら
					-1を返す
				他でr=nなら
					1を返す
				そうでなければ
					l = l+1
					r = r+1
				そして
			そして
		そして
	』で並べ替える
	idxを返す
終わり

【s：文字列】を【sa：整数の配列】で最長共通接尾辞配列する手順：整数の配列
	【n：整数】=sの文字数
	【s2：整数の配列】={}
	s2(n)=0
	n回【i：整数】にカウントしながら繰り返す
		s2(i)=sのi文字目の文字番号
	そして
	【res：整数の配列】=s2をsaで_最長共通接尾辞配列する
	resを返す
終わり

【s：整数の配列】を【sa：整数の配列】で_最長共通接尾辞配列する手順：整数の配列
	【n：整数】=sの個数
	【rnk：整数の配列】={}
	rnk(n+1)=0
	n回【i：整数】にカウントしながら繰り返す
		rnk(sa(i))=i
	そして
	【lcp：整数の配列】={}
	lcp(n)=0
	【h：整数】=0
	n回【i：整数】にカウントしながら繰り返す
		h>0なら
			h=h-1
		そして
		rnk(i)=1なら
			続ける
		そして
		【j：整数】=sa(rnk(i)-1)
		j+h≦nかつi+h≦nかつs(j+h)=s(i+h)の間繰り返す
			h = h+1
		そして
		lcp(rnk(i)-1)=h
	そして
	lcpを返す
終わり
